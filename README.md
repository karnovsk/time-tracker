# ×ž×¢×§×‘ ×–×ž×Ÿ ×¤× ××™ (Time Tracker)

××¤×œ×™×§×¦×™×™×ª ×•×•×‘ ×ž×œ××” ×œ×ž×¢×§×‘ ××—×¨ ×¤×¢×™×œ×•×™×•×ª ×¤× ××™ ×™×•×ž×™×•×ª ×¢× ××™×ž×•×ª ×ž×©×ª×ž×©×™×, × ×™×ª×•×— ×¡×˜×˜×™×¡×˜×™ ×•×ª×¦×•×’×ª ×’×¨×¤×™×.

## ×ª×›×•× ×•×ª

### ××™×ž×•×ª
- ðŸ” ×”×ª×—×‘×¨×•×ª ×‘××ž×¦×¢×•×ª OTP (×§×•×“ ×—×“-×¤×¢×ž×™) ×‘××™×ž×™×™×œ
- ðŸ”„ ×”×ª×—×‘×¨×•×ª ××•×˜×•×ž×˜×™×ª (×¤×¨×¡×™×¡×˜× ×˜×™×ª)
- ðŸ›¡ï¸ ×”×¤×¨×“×” ×ž×œ××” ×‘×™×Ÿ ×ž×©×ª×ž×©×™×

### ×¨×™×©×•× ×™×•×ž×™
- ðŸ“ ×¨×™×©×•× ×™×•×ž×™ ×©×œ ×©×¢×•×ª ×¤× ××™ ×‘×©×œ×•×© ×§×˜×’×•×¨×™×•×ª:
  - **×¤× ××™ ×ž×–×“×ž×Ÿ**: ×˜×œ×•×•×™×–×™×”, ×¨×©×ª×•×ª ×—×‘×¨×ª×™×•×ª, ×•×›×•'
  - **×¤× ××™ ×¨×¦×™× ×™**: ×¡×¤×•×¨×˜, ×œ×™×ž×•×“, ×ª×¨×’×•×œ, ×•×›×•'
  - **×¤× ××™ ×¤×¨×•×™×§×˜**: ×¤×¨×•×™×§×˜×™× ××™×©×™×™×, ×™×–×ž×•×ª, ×•×›×•'
- ðŸ“‹ ×©×“×” ×˜×§×¡×˜ ×œ×ª×™××•×¨ ×¤×¢×™×œ×•×™×•×ª ×œ×›×œ ×§×˜×’×•×¨×™×”
- ðŸš« ×¨×™×©×•× ××—×“ ×œ×™×•× ×‘×œ×‘×“ (×œ× × ×™×ª×Ÿ ×œ×¢×¨×™×›×”)
- ðŸ• ×ª×ž×™×›×” ×‘×¨×™×©×•×ž×™× ×¨×˜×¨×•××§×˜×™×‘×™×™× (×”×–× ×ª ×¨×™×©×•×ž×™× ×¢×‘×•×¨ ×™×ž×™× ×§×•×“×ž×™×)
- âœ… ×•×œ×™×“×¦×™×”: ×¡×”"×› ×©×¢×•×ª > 0 ×•- â‰¤ 24

### ×¡×˜×˜×™×¡×˜×™×§×•×ª ×•×“×•×—×•×ª
- ðŸ“Š ×¡×˜×˜×™×¡×˜×™×§×•×ª ×ž×¤×•×¨×˜×•×ª ×œ×¤×™ ×§×˜×’×•×¨×™×”:
  - ×¡×”"×› ×©×¢×•×ª
  - ×ž×ž×•×¦×¢ ×©×¢×•×ª
  - ×ž×¡×¤×¨ ×¨×™×©×•×ž×™×
- ðŸ“ˆ ×’×¨×¤×™× ××™× ×˜×¨××§×˜×™×‘×™×™×:
  - ×ª×¨×©×™× ×¢×•×’×”
  - ×ª×¨×©×™× ×¢×ž×•×“×•×ª
- ðŸ“¤ ×©×™×ª×•×£ ×¡×˜×˜×™×¡×˜×™×§×•×ª:
  - ×™×™×¦×•× ×›×ª×ž×•× ×” (PNG)
  - ×©×™×ª×•×£ ×‘××ž×¦×¢×•×ª Web Share API (×ž×•×‘×™×™×œ)
- ðŸ“œ ×˜×‘×œ×ª ×”×™×¡×˜×•×¨×™×” ×ž×¤×•×¨×˜×ª:
  - ×ª××¨×™×š
  - ×©×¢×•×ª ×•×¤×¢×™×œ×•×™×•×ª ×œ×›×œ ×§×˜×’×•×¨×™×”
  - ×¡×”"×› ×©×¢×•×ª
  - ×¤×’×™× ×¦×™×” (10 ×¨×™×©×•×ž×™× ×œ×¢×ž×•×“)
- ðŸ—‘ï¸ ××™×¤×•×¡ × ×ª×•× ×™× (×¢× ××™×©×•×¨ ×›×¤×•×œ)

### ×ž×ž×©×§ ×ž×©×ª×ž×©
- ðŸŽ¨ ×¢×™×¦×•×‘ ×ž×•×“×¨× ×™ ×•×¨×¡×¤×•× ×¡×™×‘×™
- ðŸ‡®ðŸ‡± ×ª×ž×™×›×” ×ž×œ××” ×‘×¢×‘×¨×™×ª (RTL)
- ðŸ“± ×ž×•×ª×× ×œ×ž×•×‘×™×™×œ
- ðŸŒˆ ×¦×‘×¢×™× ××˜×¨×§×˜×™×‘×™×™× ×•×’×¨×“×™×× ×˜×™×
- âš¡ ×—×•×•×™×ª ×ž×©×ª×ž×© ×—×œ×§×” ×¢× ×× ×™×ž×¦×™×•×ª

## ××¨×›×™×˜×§×˜×•×¨×”

### Backend
- **FastAPI** - ×ž×¡×’×¨×ª API ×ž×•×“×¨× ×™×ª ×•×ž×”×™×¨×”
- **PostgreSQL** - ×‘×¡×™×¡ × ×ª×•× ×™× ×™×—×¡×™
- **SQLAlchemy 2.0** - ORM ××¡×™× ×›×¨×•× ×™
- **Supabase Auth** - ×©×™×¨×•×ª ××™×ž×•×ª ×ž× ×•×”×œ
- **Alembic** - × ×™×”×•×œ ×ž×™×’×¨×¦×™×•×ª
- **Docker** - ×§×•× ×˜×™×™× ×¨×™×–×¦×™×” ×©×œ PostgreSQL

### Frontend
- **Vanilla JavaScript** - ×œ×œ× ×ª×œ×•×™×•×ª ×›×‘×“×•×ª
- **Chart.js** - ×•×™×–×•××œ×™×–×¦×™×” ×©×œ × ×ª×•× ×™×
- **html2canvas** - ×™×™×¦×•× ×¡×˜×˜×™×¡×˜×™×§×•×ª ×›×ª×ž×•× ×”
- **CSS3** - ×¢×™×¦×•×‘ ×ž×•×“×¨× ×™ ×¢× ×’×¨×“×™×× ×˜×™× ×•×× ×™×ž×¦×™×•×ª
- **HTML5** - ×¡×ž× ×˜×™ ×•× ×’×™×©

### Database Schema
```sql
users (
    id UUID PRIMARY KEY,
    supabase_user_id UUID UNIQUE,
    email VARCHAR(255) UNIQUE,
    last_entry_date DATE,
    created_at TIMESTAMP,
    updated_at TIMESTAMP
)

daily_entries (
    id UUID PRIMARY KEY,
    user_id UUID FOREIGN KEY,
    entry_date DATE,
    casual_leisure_hours FLOAT,
    casual_leisure_note TEXT,
    serious_leisure_hours FLOAT,
    serious_leisure_note TEXT,
    project_leisure_hours FLOAT,
    project_leisure_note TEXT,
    total_hours FLOAT (COMPUTED),
    created_at TIMESTAMP,
    UNIQUE(user_id, entry_date)
)
```

## ×”×ª×§× ×” ×•×”×¤×¢×œ×”

### ×“×¨×™×©×•×ª ×ž×§×“×™×ž×•×ª
- Python 3.11 or 3.12
- Docker Desktop (for PostgreSQL)
- Supabase account (free tier works)

### 1. ×”×’×“×¨×ª Supabase
1. ×’×© ×œ-https://app.supabase.com
2. ×¦×•×¨ ×¤×¨×•×™×§×˜ ×—×“×©
3. ×¢×‘×•×¨ ××œ **Authentication** â†’ **Providers**
4. ×”×¤×¢×œ **Email OTP**
5. ×©×ž×•×¨ ××ª:
   - SUPABASE_URL
   - SUPABASE_ANON_KEY
   - SUPABASE_SERVICE_KEY

### 2. ×”×’×“×¨×ª Backend

```bash
# 1. ×”×ª×§×Ÿ ×ª×œ×•×™×•×ª
cd backend
python -m venv venv
source venv/Scripts/activate  # Windows Git Bash
# ××•: venv\Scripts\activate  # Windows CMD/PowerShell
pip install -r requirements.txt

# 2. ×¦×•×¨ ×§×•×‘×¥ .env
cp .env.example .env
# ×¢×¨×•×š .env ×•×”×•×¡×£ ××ª ×¤×¨×˜×™ Supabase ×©×œ×š

# 3. ×”×¤×¢×œ PostgreSQL
cd ..
docker compose up -d

# 4. ×¦×•×¨ ×˜×‘×œ××•×ª ×‘×‘×¡×™×¡ ×”× ×ª×•× ×™×
cd backend
python create_tables.py

# 5. ×”×¤×¢×œ ××ª ×”-API
uvicorn app.main:app --reload
```

Backend ×™×”×™×” ×–×ž×™×Ÿ ×‘: **http://localhost:8000**

API Docs: **http://localhost:8000/docs**

### 3. ×”×’×“×¨×ª Frontend

```bash
# ×‘×—×œ×•×Ÿ ×˜×¨×ž×™× ×œ × ×¤×¨×“
cd frontend
python serve.py
```

Frontend ×™×”×™×” ×–×ž×™×Ÿ ×‘: **http://localhost:8080**

### 4. ×‘×“×™×§×”

1. ×¤×ª×— **http://localhost:8080** ×‘×“×¤×“×¤×Ÿ
2. ×”×–×Ÿ ××ª ×›×ª×•×‘×ª ×”××™×ž×™×™×œ ×©×œ×š
3. ×‘×“×•×§ ××ª ×”××™×ž×™×™×œ ×œ×§×•×“ OTP
4. ×”×–×Ÿ ××ª ×”×§×•×“ ×•×”×ª×—×‘×¨
5. ×”×–×Ÿ ×¨×™×©×•× ×™×•×ž×™
6. ×œ×—×¥ "×”×¦×’ ×¡×˜×˜×™×¡×˜×™×§×”" ×œ×¨××•×ª × ×™×ª×•×—×™×

## API Endpoints

### Authentication
- `POST /api/v1/auth/send-otp` - ×©×œ×— ×§×•×“ OTP ×œ××™×ž×™×™×œ
- `POST /api/v1/auth/verify-otp` - ××ž×ª OTP ×•×§×‘×œ ×˜×•×§×Ÿ
- `GET /api/v1/auth/me` - ×§×‘×œ ×¤×¨×˜×™ ×ž×©×ª×ž×© × ×•×›×—×™

### Daily Entries
- `GET /api/v1/entries/can-submit` - ×‘×“×•×§ ×× × ×™×ª×Ÿ ×œ×©×œ×•×— ×¨×™×©×•× ×”×™×•×
- `POST /api/v1/entries/today` - ×©×œ×— ×¨×™×©×•× ×œ×”×™×•× ××• ×œ×ª××¨×™×š ×ž×¡×•×™× (×¨×˜×¨×•××§×˜×™×‘×™)
- `GET /api/v1/entries/today` - ×§×‘×œ ×¨×™×©×•× ×©×œ ×”×™×•×
- `GET /api/v1/entries/history` - ×§×‘×œ ×”×™×¡×˜×•×¨×™×™×ª ×¨×™×©×•×ž×™× (×¢× ×¤×’×™× ×¦×™×”)

### Statistics
- `GET /api/v1/statistics/overview` - ×§×‘×œ ×¡×˜×˜×™×¡×˜×™×§×•×ª ×›×œ×œ×™×•×ª
- `GET /api/v1/statistics/trends` - ×§×‘×œ × ×ª×•× ×™ ×˜×¨× ×“×™× ×œ×’×¨×¤×™×
- `DELETE /api/v1/statistics/reset` - ×ž×—×§ ××ª ×›×œ ×”× ×ª×•× ×™× ×©×œ ×”×ž×©×ª×ž×©

## ×ž×‘× ×” ×”×¤×¨×•×™×§×˜

```
time-tracker/
â”œâ”€â”€ backend/
â”‚   â”œâ”€â”€ app/
â”‚   â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â”‚   â”œâ”€â”€ auth.py           # × ×§×•×“×•×ª ×§×¦×” ×œ××™×ž×•×ª
â”‚   â”‚   â”‚   â”œâ”€â”€ entries.py        # × ×§×•×“×•×ª ×§×¦×” ×œ×¨×™×©×•×ž×™×
â”‚   â”‚   â”‚   â””â”€â”€ statistics.py    # × ×§×•×“×•×ª ×§×¦×” ×œ×¡×˜×˜×™×¡×˜×™×§×•×ª
â”‚   â”‚   â”œâ”€â”€ models/
â”‚   â”‚   â”‚   â”œâ”€â”€ user.py           # ×ž×•×“×œ ×ž×©×ª×ž×©
â”‚   â”‚   â”‚   â””â”€â”€ daily_entry.py   # ×ž×•×“×œ ×¨×™×©×•× ×™×•×ž×™
â”‚   â”‚   â”œâ”€â”€ schemas/
â”‚   â”‚   â”‚   â”œâ”€â”€ auth.py           # ×¡×›×ž×•×ª Pydantic ×œ××™×ž×•×ª
â”‚   â”‚   â”‚   â”œâ”€â”€ entry.py          # ×¡×›×ž×•×ª Pydantic ×œ×¨×™×©×•×ž×™×
â”‚   â”‚   â”‚   â””â”€â”€ statistics.py    # ×¡×›×ž×•×ª Pydantic ×œ×¡×˜×˜×™×¡×˜×™×§×•×ª
â”‚   â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â”‚   â””â”€â”€ auth_service.py  # ×©×™×¨×•×ª ××™×ž×•×ª Supabase
â”‚   â”‚   â”œâ”€â”€ config.py             # ×”×’×“×¨×•×ª ××¤×œ×™×§×¦×™×”
â”‚   â”‚   â”œâ”€â”€ database.py           # ×”×’×“×¨×ª ×‘×¡×™×¡ × ×ª×•× ×™×
â”‚   â”‚   â”œâ”€â”€ dependencies.py       # ×ª×œ×•×™×•×ª FastAPI
â”‚   â”‚   â””â”€â”€ main.py               # × ×§×•×“×ª ×›× ×™×¡×” ×œ××¤×œ×™×§×¦×™×”
â”‚   â”œâ”€â”€ alembic/                  # ×ž×™×’×¨×¦×™×•×ª ×‘×¡×™×¡ × ×ª×•× ×™×
â”‚   â”œâ”€â”€ requirements.txt          # ×ª×œ×•×™×•×ª Python
â”‚   â”œâ”€â”€ .env.example              # ×ª×‘× ×™×ª ×ž×©×ª× ×™ ×¡×‘×™×‘×”
â”‚   â””â”€â”€ create_tables.py          # ×¡×§×¨×™×¤×˜ ×œ×™×¦×™×¨×ª ×˜×‘×œ××•×ª
â”œâ”€â”€ frontend/
â”‚   â”œâ”€â”€ index.html                # HTML ×¨××©×™
â”‚   â”œâ”€â”€ styles.css                # ×¢×™×¦×•×‘
â”‚   â”œâ”€â”€ app.js                    # ×œ×•×’×™×§×ª ××¤×œ×™×§×¦×™×”
â”‚   â””â”€â”€ serve.py                  # ×©×¨×ª HTTP ×¤×©×•×˜
â”œâ”€â”€ docker-compose.yml            # ×”×’×“×¨×•×ª PostgreSQL
â””â”€â”€ README.md                     # ×ž×¡×ž×š ×–×”
```

## ×¤×™×¦'×¨×™× ×ž×ª×§×“×ž×™×

### Security
- Bearer token authentication
- Password-less authentication (OTP)
- CORS protection
- SQL injection prevention (SQLAlchemy ORM)
- Input validation (Pydantic)

### Performance
- Async/await throughout the stack
- Connection pooling
- Indexed database queries
- Efficient pagination

### User Experience
- Auto-login with localStorage
- Real-time form validation
- Loading states
- Error handling
- Responsive design
- Hebrew RTL support

## Development

### Running Tests
```bash
cd backend
pytest
```

### Database Migrations
```bash
# Create new migration
alembic revision --autogenerate -m "Description"

# Apply migrations
alembic upgrade head

# Rollback migration
alembic downgrade -1
```

### Check Database
```bash
cd backend
python check_db.py
```

## Deployment

### Pre-Deployment Checklist

Before deploying to production, ensure:

- [ ] All environment variables configured in production
- [ ] PostgreSQL database provisioned (managed service recommended)
- [ ] Supabase project configured with production domain
- [ ] CORS origins updated for production domain
- [ ] DEBUG=False in production environment
- [ ] HTTPS enabled (required for Supabase)
- [ ] Security review completed
- [ ] Testing completed (authentication, entries, statistics)

### Deployment Options

**Quick Comparison:**
- **Option 1 (Railway)**: Fast, no cold starts - **~$5-10/month**
- **Option 2 (Render + Supabase)**: Free with cold starts - **$0/month** âœ¨ **Recommended for personal use**
- **Option 3 (Vercel + Supabase)**: Serverless backend - **Free tier available**
- **Option 4 (Docker + VPS)**: Full control - **$5-20/month**

---

#### Option 1: Railway (Best Performance - Paid)

**Backend + Database:**
1. Push code to GitHub repository
2. Go to [railway.app](https://railway.app)
3. Create new project â†’ Deploy from GitHub
4. Select your repository
5. Railway will auto-detect Python and create a PostgreSQL database
6. Add environment variables in Railway dashboard:
   ```
   DATABASE_URL (auto-generated)
   SUPABASE_URL
   SUPABASE_ANON_KEY
   SUPABASE_SERVICE_KEY
   ENVIRONMENT=production
   DEBUG=False
   CORS_ORIGINS=https://your-frontend-domain.com
   ```
7. Deploy command: `uvicorn app.main:app --host 0.0.0.0 --port $PORT`

**Frontend:**
- Deploy to Vercel, Netlify, or Cloudflare Pages (see below)
- Update `API_URL` in `frontend/app.js` to your Railway backend URL

#### Option 2: Render + Supabase (100% Free - Recommended)

**Perfect for personal use with zero monthly cost!**

This option uses:
- **Render** for backend (free tier with cold starts) and frontend (free, no cold starts)
- **Supabase** for database (free 500MB, you already have this!)
- **Total cost: $0/month**

**Trade-offs:**
- âš ï¸ Backend cold starts after 15 minutes of inactivity (30-60s first load)
- âœ… Frontend loads instantly (no cold starts)
- âœ… Database free forever (500MB is plenty for this app)

---

### Step 1: Set Up Supabase Database

Your Supabase project is already configured for Auth. Now add the application tables:

1. **Go to Supabase Dashboard** â†’ Your project â†’ SQL Editor

2. **Run this SQL** to create the tables:

```sql
-- Create users table
CREATE TABLE users (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    supabase_user_id UUID UNIQUE NOT NULL,
    email VARCHAR(255) UNIQUE NOT NULL,
    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
    updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
    last_entry_date DATE
);

-- Create daily_entries table
CREATE TABLE daily_entries (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id UUID NOT NULL REFERENCES users(id) ON DELETE CASCADE,
    entry_date DATE NOT NULL,
    casual_leisure_hours FLOAT NOT NULL CHECK (casual_leisure_hours >= 0),
    casual_leisure_note TEXT,
    serious_leisure_hours FLOAT NOT NULL CHECK (serious_leisure_hours >= 0),
    serious_leisure_note TEXT,
    project_leisure_hours FLOAT NOT NULL CHECK (project_leisure_hours >= 0),
    project_leisure_note TEXT,
    total_hours FLOAT GENERATED ALWAYS AS (
        casual_leisure_hours + serious_leisure_hours + project_leisure_hours
    ) STORED,
    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
    CONSTRAINT unique_user_date UNIQUE(user_id, entry_date)
);

-- Create indexes for better performance
CREATE INDEX idx_users_supabase_id ON users(supabase_user_id);
CREATE INDEX idx_entries_user_date ON daily_entries(user_id, entry_date DESC);
```

3. **Get your database connection string**:
   - Supabase Dashboard â†’ Project Settings â†’ Database
   - Connection String â†’ Transaction mode
   - Copy the string (looks like: `postgresql://postgres.[PROJECT]:[PASSWORD]@...`)
   - **Important**: Change `postgresql://` to `postgresql+asyncpg://` for SQLAlchemy
   - Example: `postgresql+asyncpg://postgres.abc123:yourpassword@aws-0-us-east-1.pooler.supabase.com:6543/postgres`

---

### Step 2: Deploy Backend to Render

1. **Push your code to GitHub** (if not already done)

2. **Go to [render.com](https://render.com)** and sign up (free account)

3. **Create New Web Service**:
   - Click "New +" â†’ "Web Service"
   - Connect your GitHub repository
   - Repository settings:
     - **Name**: `time-tracker-backend`
     - **Root Directory**: `backend`
     - **Environment**: `Python 3`
     - **Build Command**: `pip install -r requirements.txt`
     - **Start Command**: `uvicorn app.main:app --host 0.0.0.0 --port $PORT`
     - **Instance Type**: Free

4. **Add Environment Variables** (before deploying):

   Click "Advanced" â†’ Add Environment Variables:

   ```
   DATABASE_URL = postgresql+asyncpg://postgres.[YOUR-PROJECT]:[PASSWORD]@...
   SUPABASE_URL = https://your-project.supabase.co
   SUPABASE_ANON_KEY = your-anon-key-here
   SUPABASE_SERVICE_KEY = your-service-key-here
   ENVIRONMENT = production
   DEBUG = False
   CORS_ORIGINS = (will update after frontend deployment)
   ```

5. **Click "Create Web Service"** - Render will build and deploy (takes 2-3 minutes)

6. **Copy your backend URL**: Will be something like `https://time-tracker-backend.onrender.com`

---

### Step 3: Deploy Frontend to Render

1. **Update API URL** in your local code:

   Edit `frontend/app.js` line 2:
   ```javascript
   const API_URL = 'https://time-tracker-backend.onrender.com/api/v1';
   ```

2. **Commit and push** this change to GitHub:
   ```bash
   git add frontend/app.js
   git commit -m "Update API URL for production"
   git push
   ```

3. **Create Static Site on Render**:
   - Dashboard â†’ New + â†’ Static Site
   - Connect your GitHub repository
   - Settings:
     - **Name**: `time-tracker-frontend`
     - **Root Directory**: Leave empty
     - **Build Command**: Leave empty (no build needed)
     - **Publish Directory**: `frontend`

4. **Click "Create Static Site"** - Deploys in ~30 seconds

5. **Copy your frontend URL**: Will be something like `https://time-tracker-frontend.onrender.com`

---

### Step 4: Update Backend CORS

1. **Go back to your backend Web Service** on Render

2. **Environment** â†’ Edit `CORS_ORIGINS`:
   ```
   CORS_ORIGINS = https://time-tracker-frontend.onrender.com
   ```

3. **Save** - Render will automatically redeploy the backend

---

### Step 5: Configure Supabase Auth

1. **Supabase Dashboard** â†’ Authentication â†’ URL Configuration

2. **Update URLs**:
   - **Site URL**: `https://time-tracker-frontend.onrender.com`
   - **Redirect URLs**: Add `https://time-tracker-frontend.onrender.com/**`

3. **Authentication â†’ Settings** â†’ Scroll down:
   - Ensure "Enable email confirmations" is OFF (for OTP to work)

---

### Step 6: Test Your Deployment

1. Visit your frontend URL: `https://time-tracker-frontend.onrender.com`
2. Enter your email â†’ Receive OTP
3. Login â†’ Submit an entry
4. View statistics â†’ Share statistics
5. Success! ðŸŽ‰

**Note on Cold Starts**: First request after 15 minutes of inactivity will take 30-60 seconds as the backend wakes up. Subsequent requests are instant.

---

### Optional: Keep Backend Awake (Free Method)

Use a free uptime monitor to ping your backend every 14 minutes:

1. **Sign up at [UptimeRobot](https://uptimerobot.com)** (free)
2. **Add New Monitor**:
   - Type: HTTP(s)
   - URL: `https://time-tracker-backend.onrender.com/docs`
   - Interval: 14 minutes
3. This keeps your backend awake = no cold starts!

---

**Total Monthly Cost: $0** âœ¨

#### Option 3: Vercel (Frontend) + Supabase (Backend Alternative)

If you want to leverage Supabase fully:

1. **Database**: Use Supabase's built-in PostgreSQL
   - Go to Supabase project â†’ Database
   - Run SQL to create tables (from `backend/app/models/`)

2. **Backend**: Deploy FastAPI to Vercel as a Serverless Function
   - Create `api/index.py` with Vercel adapter
   - Or deploy backend separately (Railway/Render)

3. **Frontend**: Deploy to Vercel
   - `cd frontend`
   - `vercel deploy`
   - Update `API_URL` in `app.js`

#### Option 4: Docker + VPS (DigitalOcean, Linode, AWS EC2)

**For advanced users who want full control:**

1. **Create Dockerfile for backend:**
```dockerfile
FROM python:3.12-slim
WORKDIR /app
COPY backend/requirements.txt .
RUN pip install -r requirements.txt
COPY backend/ .
CMD ["uvicorn", "app.main:app", "--host", "0.0.0.0", "--port", "8000"]
```

2. **Update docker-compose.yml for production:**
```yaml
version: '3.8'
services:
  backend:
    build: .
    ports:
      - "8000:8000"
    environment:
      - DATABASE_URL=postgresql+asyncpg://user:pass@db:5432/timetracker
      - SUPABASE_URL=${SUPABASE_URL}
      - SUPABASE_ANON_KEY=${SUPABASE_ANON_KEY}
    depends_on:
      - db

  db:
    image: postgres:15
    environment:
      - POSTGRES_DB=timetracker
      - POSTGRES_USER=user
      - POSTGRES_PASSWORD=securepassword
    volumes:
      - postgres_data:/var/lib/postgresql/data

  frontend:
    image: nginx:alpine
    ports:
      - "80:80"
    volumes:
      - ./frontend:/usr/share/nginx/html

volumes:
  postgres_data:
```

3. **Deploy:**
```bash
# On VPS
docker-compose up -d
```

4. **Set up Nginx reverse proxy** for HTTPS (with Let's Encrypt)

### Frontend Deployment Details

**Update API URL for Production:**

In `frontend/app.js`, change:
```javascript
const API_URL = 'http://localhost:8000/api/v1';
```

To:
```javascript
const API_URL = 'https://your-backend-domain.com/api/v1';
```

**Deploy to Vercel:**
```bash
cd frontend
npm init -y  # If no package.json
vercel deploy --prod
```

**Deploy to Netlify:**
```bash
cd frontend
netlify deploy --prod --dir .
```

**Deploy to Cloudflare Pages:**
1. Go to Cloudflare Pages dashboard
2. Connect GitHub repository
3. Build settings:
   - Build command: (none - static files)
   - Build output directory: `frontend`
4. Deploy

### Post-Deployment

1. **Test the full flow:**
   - Login with OTP
   - Submit entry
   - View statistics
   - Share statistics
   - Reset data

2. **Update Supabase settings:**
   - Go to Authentication â†’ URL Configuration
   - Add your production domain to allowed redirect URLs
   - Add production domain to CORS allowed origins

3. **Monitor:**
   - Set up error tracking (Sentry, LogRocket)
   - Monitor database performance
   - Set up uptime monitoring (UptimeRobot, Pingdom)

4. **Backup:**
   - Enable automated database backups
   - Railway/Render: Built-in backups
   - Self-hosted: Set up `pg_dump` cronjob

### Environment Variables Reference

**Required for Production:**
```env
# Database
DATABASE_URL=postgresql+asyncpg://user:pass@host:5432/db

# Supabase
SUPABASE_URL=https://xxxxx.supabase.co
SUPABASE_ANON_KEY=eyJxxx...
SUPABASE_SERVICE_KEY=eyJxxx...

# FastAPI
ENVIRONMENT=production
DEBUG=False

# CORS
CORS_ORIGINS=https://yourdomain.com,https://www.yourdomain.com

# Server (auto-set by most platforms)
HOST=0.0.0.0
PORT=8000
```

### Security Checklist for Production

- [ ] Use HTTPS everywhere (frontend + backend)
- [ ] Update CORS origins to only your frontend domain
- [ ] Enable rate limiting (consider adding slowapi middleware)
- [ ] Review Supabase security rules
- [ ] Set up database connection pooling limits
- [ ] Enable database SSL connection
- [ ] Keep dependencies updated (`pip list --outdated`)
- [ ] Set up logging and monitoring
- [ ] Configure Supabase email templates (branding)

## Troubleshooting

### Backend Issues
- **Port 8000 in use**: Kill the process or use `uvicorn app.main:app --port 8001`
- **Database connection error**: Make sure Docker is running (`docker ps`)
- **Timezone error**: Already fixed in config (see docker-compose.yml and database.py)
- **Missing email-validator**: `pip install email-validator`

### Frontend Issues
- **CORS errors**: Make sure backend is running with correct CORS settings
- **API URL wrong**: Check `API_URL` in app.js (should be `http://localhost:8000/api/v1`)
- **Token expired**: Logout and login again

### Supabase Issues
- **Not receiving OTP**: Check spam folder, verify email provider settings in Supabase
- **Magic link instead of OTP**: Enable "Email OTP" in Supabase Auth settings

## Future Enhancements

Possible future features:
- [ ] Export data to CSV/JSON
- [ ] Weekly/monthly email reports
- [ ] Goals and achievements
- [ ] Data visualization improvements (line charts, trends)
- [ ] Mobile app (React Native)
- [ ] Multi-language support
- [ ] Dark mode
- [ ] Social features (compare with friends)

## License

This project is open source and available under the MIT License.

## Credits

Built with:
- [FastAPI](https://fastapi.tiangolo.com/)
- [SQLAlchemy](https://www.sqlalchemy.org/)
- [Supabase](https://supabase.com/)
- [Chart.js](https://www.chartjs.org/)
- [html2canvas](https://html2canvas.hertzen.com/)
- [PostgreSQL](https://www.postgresql.org/)
- [Docker](https://www.docker.com/)

---

**Enjoy tracking your leisure time! ðŸŽ‰**
